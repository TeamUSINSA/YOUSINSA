<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.order">

  <!-- 주문 저장 -->
  <insert id="insertOrder" parameterType="order" useGeneratedKeys="true" keyProperty="orderId">
    INSERT INTO order_list (
      order_date,
      total_price,
      delivery_status,
      delivery_request,
      delivery_method,
      payment_method,
      user_id,
      point_id,
      receiver_name,
      receiver_phone,
      receiver_address
    ) VALUES (
      #{orderDate},
      #{totalPrice},
      #{deliveryStatus},
      #{deliveryRequest},
      #{deliveryMethod},
      #{paymentMethod},
      #{userId},
      #{pointId},
      #{receiverName},
      #{receiverPhone},
      #{receiverAddress}
    )
  </insert>

  <!-- 주문 아이템 저장 -->
  <insert id="insertOrderItem" parameterType="orderItem">
    INSERT INTO order_item (
      order_id,
      product_id,
      quantity,
      status,
      coupon_id,
      color,
      size
    ) VALUES (
      #{orderId},
      #{productId},
      #{quantity},
      #{status},
      #{couponId},
      #{color},
      #{size}
    )
  </insert>

  <!-- 사용자별 주문 리스트 조회 -->
  <select id="selectOrderListByUser"
          parameterType="string"
          resultType="dto.order.OrderList">
    SELECT
      order_id,
      order_date,
      total_price,
      delivery_status,
      delivery_request,
      delivery_method,
      payment_method,
      user_id,
      point_id,
      receiver_name,
      receiver_phone,
      receiver_address
    FROM order_list
    WHERE user_id = #{userId}
    ORDER BY order_date DESC
  </select>

</mapper>
